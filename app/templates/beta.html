<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, minimal-ui">
<title>Графы - максимальная клика</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/4.10.3/css/bootstrap-slider.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<link href="http://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.css" rel="stylesheet" type="text/css" />
<link href="http://js.cytoscape.org/demos/2ebdc40f1c2540de6cf0/style.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.0/lodash.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/4.10.3/bootstrap-slider.min.js"></script>
    <script src="http://marvl.infotech.monash.edu/webcola/cola.v3.min.js"></script>

    <script src="http://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js"></script>
    <script src="https://cdn.rawgit.com/cytoscape/cytoscape.js-qtip/2.2.5/cytoscape-qtip.js"></script>
    <script src="https://cdn.rawgit.com/cytoscape/cytoscape.js-cola/1.1.1/cytoscape-cola.js"></script>
        <script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="http://firstvector.org/examples/jTap/plugin/jquery.tap.js"></script>

        <script src="http://cytoscape.github.io/cytoscape.js/api/cytoscape.js-latest/cytoscape.min.js"></script>
        <script src="cytoscape-edge.js"></script>


<script>
    var cy;


$(function(){

  cy = cytoscape({
    
                    container: document.getElementById('cy'),
                    ready: function(){
                    },
                    layout: {
                        name: 'grid',
                        rows: 2,
                        cols: 2
                    },
                    style: [
                        {
                            selector: 'node',
              style: {
                shape: 'round',
                'background-color': '#808000',
                label: 'data(id)',
                'text-valign': 'center',
            'color': 'white',
            'text-outline-width': 1,
            'text-outline-color': 'black'
                            }
                        },
                        {
                            selector: '.edgehandles-hover',
                            css: {
                                'background-color': 'red'
                            }
                        },
                        {
                            selector: '.edgehandles-source',
                            css: {
                                'border-width': 2,
                                'border-color': 'red'
                            }
                        },
                        {
                            selector: '.edgehandles-target',
                            css: {
                                'border-width': 2,
                                'border-color': 'red'
                            }
                        },
                        {
                            selector: '.edgehandles-preview, .edgehandles-ghost-edge',
                            css: {
                                'line-color': 'red',
                                'target-arrow-color': 'red',
                                'source-arrow-color': 'red'
                            }
                        }
                    ]
  });

      cy.edgehandles({
   toggleOffOnLeave: true,
   handleNodes: "node",
   handleSize: 10,
   edgeType: function(){ return 'flat'; }
 });
    var i = 0;
    var del_elem = [];
    cy.on('cxttap', 'node' ,function (evt) {
        cy.remove(cy.$("#" + evt.cyTarget.id()));
        del_elem[del_elem.length] = evt.cyTarget.id();
    });
    cy.on('cxttap', 'edge' ,function (evt) {
        cy.remove(cy.$("#" + evt.cyTarget.id()));
    });
    var can = true;
    $('.cytosc').on('tap', '*',function(e) {

            if(del_elem.length == 0) {
                i += 1;
                index = i;
            } else {
                del_elem = del_elem.sort();
                index = del_elem[0];
                del_elem.splice(0,1);
            }
            cy.add([{
                group : "nodes",

                data : {
                    id : index
                },
                renderedPosition : {
                    x: e.pageX,
                    y: e.pageY
                }

            }]);
    });
  var $config = $('#config');
  var $btnParam = $('<div class="param"></div>');
  $config.append( $btnParam );
  var buttons = [
    {
      label: '<i class="fa fa-eye"></i>',
    },
    {
      label: '<i class="fa fa-remove"></i>'
    },
    {
      label: '<i class="fa fa-check"></i>'
    }
  ];
  buttons.forEach( makeButton );

function makeButton( opts ){
    var $button = $('<button class="btn btn-default">'+ opts.label +'</button>');
    
    $btnParam.append( $button );

    $button.on('click', function(){
      alert("123");

      if( opts.fn ){ opts.fn(); }

    });
  }

  cy.nodes().forEach(function(n){
    var g = n.data('name');

    n.qtip({
      position: {
        my: 'top center',
        at: 'bottom center'
      },
      style: {
        classes: 'qtip-bootstrap',
        tip: {
          width: 16,
          height: 8
        }
      }
    });
  });

  $('#config-toggle').on('click', function(){
    $('body').toggleClass('config-closed');
    cy.resize();
  });
});

$(function() {
  FastClick.attach( document.body );
});

</script>
</head>
<body>
<div id="cy", class = "cytosc"></div>
<span class="fa fa-bars config-toggle" id="config-toggle"></span>
<div id="config" class="config">
<div class="preamble">
<span class="label label-info">Информационная панель</span>

<p>Левая кнопка мыши на пустом поле создаёт вершину</p>

<p>Чтобы добавить ребро нужно провести его от красного кружка сверху от вершины</p>

<p>Правая кнопка мыши по элементу удаляет его</p>
</div>
</div>
</body>
</html>